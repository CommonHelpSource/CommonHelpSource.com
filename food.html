<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Food Access Assessment - CommonHelpSource</title>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #ff6b35;
      --primary-hover: #ff8659;
      --text-color: #2d3436;
      --border-radius: 12px;
      --box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    }

    body {
      margin: 0;
      font-family: 'Open Sans', sans-serif;
      background: #f5f6f7;
      color: var(--text-color);
      line-height: 1.6;
      min-height: 100vh;
      background-image: url('https://images.unsplash.com/photo-1550989460-0adf9ea622e2?auto=format&fit=crop&w=1920');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.9);
      z-index: -1;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }

    .assessment-card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 40px;
      margin-bottom: 30px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    h1 {
      font-size: 2.5rem;
      margin: 0 0 15px;
      color: var(--text-color);
    }

    .subtitle {
      color: #636e72;
      font-size: 1.1rem;
    }

    .question-section {
      margin-bottom: 30px;
      padding: 20px;
      border-radius: 8px;
      background: #f8f9fa;
      transition: all 0.3s ease;
    }

    .question-section.answered {
      border-left: 4px solid var(--primary-color);
    }

    .question {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 20px;
    }

    .options {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }

    .option-btn {
      flex: 1;
      padding: 12px 24px;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      background: var(--primary-color);
      color: white;
      font-family: inherit;
    }

    .option-btn:hover {
      background: var(--primary-hover);
      transform: translateY(-1px);
    }

    .option-btn.selected {
      background: #00b894;
    }

    .resources {
      display: none;
      margin-top: 20px;
      padding: 15px;
      background: white;
      border-radius: 8px;
      border-left: 4px solid #00b894;
    }

    .resources.visible {
      display: block;
      animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .resource-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .resource-item {
      margin-bottom: 12px;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 6px;
      transition: all 0.3s ease;
    }

    .resource-item:hover {
      background: #e9ecef;
      transform: translateX(5px);
    }

    .resource-link {
      color: #0984e3;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .resource-link:hover {
      color: #0a93ff;
    }

    .resource-icon {
      font-size: 1.2rem;
    }

    .zip-display {
      text-align: center;
      margin-bottom: 20px;
      padding: 10px;
      background: #f1f2f6;
      border-radius: 6px;
      font-size: 0.9rem;
      color: #636e72;
    }

    @media (max-width: 768px) {
      .container {
        padding: 20px;
      }

      .assessment-card {
        padding: 20px;
      }

      .options {
        flex-direction: column;
      }

      .option-btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="overlay"></div>
  <script src="assets/js/header.js"></script>
  <div class="container">
    <div class="assessment-card">
      <div class="header">
        <h1>Food Access Assessment</h1>
        <div class="subtitle">Let's find food resources in your area</div>
      </div>

      <div class="zip-display">
        Showing resources for ZIP code: <span id="userZip">Loading...</span>
      </div>

      <div id="enough_food" class="question-section">
        <div class="question">Do you currently have enough food to eat every day?</div>
        <div class="options">
          <button class="option-btn" onclick="handleAnswer('enough_food', 'yes')">Yes</button>
          <button class="option-btn" onclick="handleAnswer('enough_food', 'no')">No</button>
        </div>
        <div class="resources" id="enough_food_resources"></div>
      </div>

      <div id="skipped_meals" class="question-section">
        <div class="question">Have you skipped meals in the past week due to cost or access?</div>
        <div class="options">
          <button class="option-btn" onclick="handleAnswer('skipped_meals', 'yes')">Yes</button>
          <button class="option-btn" onclick="handleAnswer('skipped_meals', 'no')">No</button>
        </div>
        <div class="resources" id="skipped_meals_resources"></div>
      </div>

      <div id="snap_enrollment" class="question-section">
        <div class="question">Are you currently enrolled in SNAP?</div>
        <div class="options">
          <button class="option-btn" onclick="handleAnswer('snap_enrollment', 'yes')">Yes</button>
          <button class="option-btn" onclick="handleAnswer('snap_enrollment', 'no')">No</button>
        </div>
        <div class="resources" id="snap_enrollment_resources"></div>
      </div>

      <div id="has_transportation" class="question-section">
        <div class="question">Do you have transportation or delivery options to get groceries or meals?</div>
        <div class="options">
          <button class="option-btn" onclick="handleAnswer('has_transportation', 'yes')">Yes</button>
          <button class="option-btn" onclick="handleAnswer('has_transportation', 'no')">No</button>
        </div>
        <div class="resources" id="has_transportation_resources"></div>
      </div>

      <div id="wants_help_applying" class="question-section">
        <div class="question">Would you like help applying for food benefits (like SNAP, WIC, or free meal programs)?</div>
        <div class="options">
          <button class="option-btn" onclick="handleAnswer('wants_help_applying', 'yes')">Yes</button>
          <button class="option-btn" onclick="handleAnswer('wants_help_applying', 'no')">No</button>
        </div>
        <div class="resources" id="wants_help_applying_resources"></div>
      </div>
    </div>
  </div>

  <script>
    const foodAccessResources = {
      "enough_food": {
        "no": [
          "https://www.mass.gov/info-details/find-a-food-pantry-near-you",
          "https://www.feedingamerica.org/find-your-local-foodbank"
        ]
      },
      "skipped_meals": {
        "yes": [
          "https://projectbread.org/get-help",
          "https://www.mealsonwheelsamerica.org/"
        ]
      },
      "snap_enrollment": {
        "no": [
          "https://dtaconnect.eohhs.mass.gov/apply",
          "https://www.mass.gov/how-to/apply-for-snap-benefits-food-stamps"
        ]
      },
      "has_transportation": {
        "no": [
          "https://www.foodbankwma.org/programs/mobile-food-bank/",
          "https://www.mealsonwheelsamerica.org/"
        ]
      },
      "wants_help_applying": {
        "yes": [
          "https://www.gettingsnap.org/",
          "https://projectbread.org/get-help"
        ]
      }
    };

    // Load ZIP code on page load
    document.addEventListener('DOMContentLoaded', function() {
      const zip = localStorage.getItem('zip');
      if (zip) {
        document.getElementById('userZip').textContent = zip;
      } else {
        document.getElementById('userZip').textContent = 'Not available';
      }
    });

    function handleAnswer(questionId, answer) {
      // Update button styles
      const section = document.getElementById(questionId);
      const buttons = section.querySelectorAll('.option-btn');
      buttons.forEach(btn => btn.classList.remove('selected'));
      const selectedBtn = Array.from(buttons).find(btn => 
        btn.textContent.toLowerCase() === answer.toLowerCase()
      );
      if (selectedBtn) selectedBtn.classList.add('selected');

      // Mark section as answered
      section.classList.add('answered');

      // Check for resources
      const resourcesDiv = document.getElementById(`${questionId}_resources`);
      const resources = foodAccessResources[questionId]?.[answer];

      if (resources) {
        const zip = localStorage.getItem('zip');
        const resourceLinks = resources.map(url => {
          // Append ZIP code to URLs that might support it
          const finalUrl = url.includes('?') ? `${url}&zip=${zip}` : `${url}?zip=${zip}`;
          return `
            <li class="resource-item">
              <a href="${finalUrl}" target="_blank" class="resource-link">
                <span class="resource-icon">ðŸ”—</span>
                ${getResourceTitle(url)}
              </a>
            </li>
          `;
        }).join('');

        resourcesDiv.innerHTML = `
          <h4>Available Resources:</h4>
          <ul class="resource-list">
            ${resourceLinks}
          </ul>
        `;
        resourcesDiv.classList.add('visible');
      } else {
        resourcesDiv.classList.remove('visible');
      }
    }

    function getResourceTitle(url) {
      // Extract readable titles from URLs
      const domain = url.replace(/https?:\/\/(www\.)?/, '').split('/')[0];
      const title = domain
        .split('.')
        .slice(0, -1)
        .join('.')
        .split('-')
        .map(word => word.charAt(0).toUpperCase() + word.slice(1))
        .join(' ');
      return title || 'Resource Link';
    }
  </script>
</body>
</html>
